<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Comparison Features &#8212; hlink 4.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=42d1b3bd"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Feature Selection Transforms" href="feature_selection_transforms.html" />
    <link rel="prev" title="Comparisons" href="comparisons.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="comparison-features">
<h1>Comparison Features<a class="headerlink" href="#comparison-features" title="Link to this heading">¶</a></h1>
<p>During matching, hlink computes comparison features on each record pair which
it considers a potential match. These comparison features can be passed as
features to machine-learning algorithms or used to define
<a class="reference internal" href="comparisons.html"><span class="doc">comparisons</span></a> which filter the <code class="docutils literal notranslate"><span class="pre">potential_matches</span></code> table.</p>
<p>Each comparison feature must have a comparison type, which tells hlink how to
compute the comparison feature. This page has information on the available
comparison types and how to configure them. It also lists some attributes
available to all comparison types and some predefined aggregate features which
do not need to be explicitly configured.</p>
<section id="comparison-types">
<h2>Comparison Types<a class="headerlink" href="#comparison-types" title="Link to this heading">¶</a></h2>
<p>Each section below describes a comparison type. Each type represents a
different operation, computation, or transformation that hlink can perform on
one or more input columns. Some comparison types expect their own attributes
for additional configuration. These attributes are listed in each section,
along with an example.</p>
<section id="maximum-jaro-winkler">
<h3>maximum_jaro_winkler<a class="headerlink" href="#maximum-jaro-winkler" title="Link to this heading">¶</a></h3>
<p>Finds the greatest Jaro-Winkler value among the cartesian product of multiple
columns.  For example, given an input of <code class="docutils literal notranslate"><span class="pre">column_names</span> <span class="pre">=</span> <span class="pre">['namefrst',</span> <span class="pre">'namelast']</span></code>, it would return the maximum Jaro-Winkler name comparison value
among the following four comparisons:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">namefrst</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">namefrst</span>
<span class="n">a</span><span class="o">.</span><span class="n">namefrst</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">namelast</span>
<span class="n">a</span><span class="o">.</span><span class="n">namelast</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">namefrst</span>
<span class="n">a</span><span class="o">.</span><span class="n">namelast</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">namelast</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings.  Required.  The list of columns
used as input for the set of comparisons, which are generated by taking the
Cartesian product of the set of input columns with itself.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;maximum_jw&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namelast&quot;</span><span class="p">,</span> <span class="s2">&quot;namefrst&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;maximum_jaro_winkler&quot;</span>
</pre></div>
</div>
</section>
<section id="jaro-winkler">
<h3>jaro_winkler<a class="headerlink" href="#jaro-winkler" title="Link to this heading">¶</a></h3>
<p>Returns the Jaro-Winkler comparison score for a given column.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required.  The column to compare using the Jaro-Winkler score.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_jw&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler</span>
</pre></div>
</div>
</section>
<section id="jaro-winkler-street">
<h3>jaro_winkler_street<a class="headerlink" href="#jaro-winkler-street" title="Link to this heading">¶</a></h3>
<p>Uses an additional geographic column value to filter for major location changes before comparing street names.  If boundary column A is not equal to boundary column B, a Jaro-Winkler score of zero is returned.  If boundary column A and B are equal, the Jaro-Winkler comparison score of the street columns is returned.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The input street column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boundary</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required.  An input column to match on before comparing street name values.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;jw_street&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;street&quot;</span>
<span class="n">boundary</span> <span class="o">=</span> <span class="s2">&quot;enum_dist&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler_street&quot;</span>
</pre></div>
</div>
</section>
<section id="max-jaro-winkler">
<h3>max_jaro_winkler<a class="headerlink" href="#max-jaro-winkler" title="Link to this heading">¶</a></h3>
<p>Returns the greatest Jaro-Winkler value from the comparisons of a list of names.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required.  Input column containing a list of names to compare (such as related household members, or neighborhood surnames).</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;related_individual_max_jw&quot;</span>
<span class="n">column_name</span><span class="o">=</span> <span class="s2">&quot;namefrst_related&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;max_jaro_winkler&quot;</span>
</pre></div>
</div>
</section>
<section id="equals">
<h3>equals<a class="headerlink" href="#equals" title="Link to this heading">¶</a></h3>
<p>Asserts that values are the same for both compared columns using SQL: <code class="docutils literal notranslate"><span class="pre">a.{column_name}</span> <span class="pre">IS</span> <span class="pre">NOT</span> <span class="pre">DISTINCT</span> <span class="pre">FROM</span> <span class="pre">b.{column_name}</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;relatematch&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;relate_div_100&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="f1-match">
<h3>f1_match<a class="headerlink" href="#f1-match" title="Link to this heading">¶</a></h3>
<p>Evaluates if the first name initial A matches either the first name first initial B or either the first or second middle initial of B.  If so, returns 1.  Otherwise, returns 2.</p>
<p>1 = First initial of first first name A matches first initial of any of potential match first names B</p>
<p>2 = mismatch</p>
<p>Uses the following SQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;CASE WHEN (</span>
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">fi</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">fi</span><span class="p">})</span> <span class="n">OR</span> 
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">fi</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">})</span> <span class="n">OR</span>
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">fi</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">})</span>
<span class="p">)</span> <span class="n">THEN</span> <span class="mi">1</span> <span class="n">ELSE</span> <span class="mi">2</span> <span class="n">END</span><span class="s2">&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;f1_match&quot;</span>
<span class="n">first_init_col</span> <span class="o">=</span> <span class="s2">&quot;namefrst_init&quot;</span>
<span class="n">mid_init_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namefrst_mid_init&quot;</span><span class="p">,</span> <span class="s2">&quot;namefrst_mid_init_2&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;f1_match&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="f2-match">
<h3>f2_match<a class="headerlink" href="#f2-match" title="Link to this heading">¶</a></h3>
<p>Evaluates if first middle initial A is empty/null.  If so, return 0.
Otherwise, if either first or second middle initial A is not null and matches first name initial B, or first or second middle initial B, return 1.
Otherwise, return 2.</p>
<p>1 = First initial of A second first name matches first initial of any of potential match first names B</p>
<p>2 = mismatch</p>
<p>0 = no second first name A</p>
<p>Uses the following SQL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">}</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="n">OR</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NULL</span><span class="p">))</span> <span class="n">THEN</span> <span class="mi">0</span> <span class="n">WHEN</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">fi</span><span class="p">})</span> <span class="n">OR</span>
    <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">)</span> <span class="n">AND</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">fi</span><span class="p">}))</span> <span class="n">OR</span>
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">})</span> <span class="n">OR</span>
    <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">})</span> <span class="n">OR</span>
    <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">)</span> <span class="n">AND</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">mi0</span><span class="p">}))</span> <span class="n">OR</span>
    <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">)</span> <span class="n">AND</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">DISTINCT</span> <span class="n">FROM</span> <span class="n">b</span><span class="o">.</span><span class="p">{</span><span class="n">mi1</span><span class="p">}))</span>
<span class="p">)</span> <span class="n">THEN</span> <span class="mi">1</span> <span class="n">ELSE</span> <span class="mi">2</span> <span class="n">END</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">first_init_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required.  First name initial input column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mid_init_cols</span></code> – Type: list of strings.  Required.  List of first and second middle initial input columns.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;f2_match&quot;</span>
<span class="n">first_init_col</span> <span class="o">=</span> <span class="s2">&quot;namefrst_init&quot;</span>
<span class="n">mid_init_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namefrst_mid_init&quot;</span><span class="p">,</span> <span class="s2">&quot;namefrst_mid_init_2&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;f2_match&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="not-equals">
<h3>not_equals<a class="headerlink" href="#not-equals" title="Link to this heading">¶</a></h3>
<p>Asserts that values are distinct between compared individuals using SQL: <code class="docutils literal notranslate"><span class="pre">a.{column_name}</span> <span class="pre">IS</span> <span class="pre">DISTINCT</span> <span class="pre">FROM</span> <span class="pre">b.{column_name}</span></code>.  Used mainly in caution flag features (f_caution, m_caution, sp_caution).</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Input column to compare.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;m_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mbpl&quot;</span><span class="p">,</span> <span class="s2">&quot;mother_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;stepmom&quot;</span><span class="p">,</span> <span class="s2">&quot;momloc&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;caution_comp_4&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;mbpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;mother_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">gt_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;stepmom&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;parent_step_change&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_d</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;momloc&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;present_both_years&quot;</span>
</pre></div>
</div>
</section>
<section id="equals-as-int">
<h3>equals_as_int<a class="headerlink" href="#equals-as-int" title="Link to this heading">¶</a></h3>
<p>Checks for equality using equals sign and returns boolean result in integer form.  Uses SQL: <code class="docutils literal notranslate"><span class="pre">CAST(a.{col}</span> <span class="pre">=</span> <span class="pre">b.{col}</span> <span class="pre">as</span> <span class="pre">INT)</span></code></p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Input column to compare.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namelast_equal_as_int&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namelast_clean&quot;</span>
<span class="n">comparison_type</span>  <span class="o">=</span> <span class="s2">&quot;equals_as_int&quot;</span>
</pre></div>
</div>
</section>
<section id="all-equals">
<h3>all_equals<a class="headerlink" href="#all-equals" title="Link to this heading">¶</a></h3>
<p>Asserts whether the values in all given columns match.  Uses a SQL expression generated by joining <code class="docutils literal notranslate"><span class="pre">a.{col}</span> <span class="pre">=</span> <span class="pre">b.{col}</span></code> and <code class="docutils literal notranslate"><span class="pre">AND</span></code> for each given column.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings.  Required. List of the columns to evaluate if all are equal across records being compared.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namefrst_unstd&quot;</span><span class="p">,</span> <span class="s2">&quot;namelast_clean&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;all_equals&quot;</span>
</pre></div>
</div>
</section>
<section id="not-zero-and-not-equals">
<h3>not_zero_and_not_equals<a class="headerlink" href="#not-zero-and-not-equals" title="Link to this heading">¶</a></h3>
<p>Checks that both values are present (not null) and nonzero and that they are not equal to one another. Evaluates
to a boolean. This is primarily useful when a value of 0 indicates some kind of incomparibility akin to the
value being missing.</p>
<p>See also <a class="reference external" href="#present-and-equal-categorical-in-universe">present_and_equal_categorical_in_universe</a>, which is a similar
but more general comparison type.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Input column to compare.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;fbpl_nomatch&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;fbpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_zero_and_not_equals&quot;</span>
</pre></div>
</div>
</section>
<section id="or">
<h3>or<a class="headerlink" href="#or" title="Link to this heading">¶</a></h3>
<p>Allows for the concatenation of up to four comparison features into one feature using a SQL <code class="docutils literal notranslate"><span class="pre">OR</span></code> between the generated clause for each sub-comparison.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code> – Type: Object. Required.  Sub-comparison using any of the comparison feature types documented in this section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_c</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_d</span></code> – Type: Object. Optional.  Sub-comparison using any of the comparison feature types documented in this section.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;sp_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spouse_bpl&quot;</span><span class="p">,</span> <span class="s2">&quot;spouse_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;durmarr&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;or&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_bpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">lower_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;new_marr&quot;</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</section>
<section id="and">
<h3>and<a class="headerlink" href="#and" title="Link to this heading">¶</a></h3>
<p>Allows for the concatenation of up to four comparison features into one feature using a SQL <code class="docutils literal notranslate"><span class="pre">AND</span></code> between the generated clause for each sub-comparison.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code> – Type: Object. Required.  Sub-comparison using any of the comparison feature types documented in this section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_c</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_d</span></code> – Type: Object. Optional.  Sub-comparison using any of the comparison feature types documented in this section.</p></li>
</ul>
</li>
</ul>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">and</span></code> comparison appears in <code class="docutils literal notranslate"><span class="pre">[comparison_features.comp_b]</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;street_jw&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;times&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;street&quot;</span><span class="p">,</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;street&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>
<span class="n">lower_threshold</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;and&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;county&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
</pre></div>
</div>
</section>
<section id="times">
<h3>times<a class="headerlink" href="#times" title="Link to this heading">¶</a></h3>
<p>Takes the output of two sub-comparisons and multiplies them together after casting as floats.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code> – Type: Object. Required.  Sub-comparison using any of the comparison feature types documented in this section.  <code class="docutils literal notranslate"><span class="pre">comp_a</span></code> and <code class="docutils literal notranslate"><span class="pre">comp_b</span></code> can also have sub-comparisons, as in the given example.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;street_jw&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;times&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;street&quot;</span><span class="p">,</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;street&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>
<span class="n">lower_threshold</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;and&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;county&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
</pre></div>
</div>
</section>
<section id="caution-comp-3">
<h3>caution_comp_3<a class="headerlink" href="#caution-comp-3" title="Link to this heading">¶</a></h3>
<p>Generates an SQL expression in the form <code class="docutils literal notranslate"><span class="pre">(comparison</span> <span class="pre">A</span> <span class="pre">OR</span> <span class="pre">comparison</span> <span class="pre">B)</span> <span class="pre">AND</span> <span class="pre">comparison</span> <span class="pre">C</span></code>.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_c</span></code> – Type: Object. Required.  Sub-comparisons using any of the comparison feature types documented in this section.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;sp_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spouse_bpl&quot;</span><span class="p">,</span> <span class="s2">&quot;spouse_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;durmarr&quot;</span><span class="p">,</span> <span class="s2">&quot;sploc&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;caution_comp_3&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_bpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">gt_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;new_marr&quot;</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</section>
<section id="caution-comp-3-012">
<h3>caution_comp_3_012<a class="headerlink" href="#caution-comp-3-012" title="Link to this heading">¶</a></h3>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">caution_comp_3</span></code>, but first checks the value of comparison C. If comparison C evaluates to false,
then <code class="docutils literal notranslate"><span class="pre">caution_comp_3_012</span></code> evaluates to 2. Otherwise, it evaluates to the result of <code class="docutils literal notranslate"><span class="pre">caution_comp_3</span></code>, so 0 or 1.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_c</span></code> – Type: Object. Required. Sub-comparison using any of the comparison feature types documented in this section.</p></li>
</ul>
</li>
</ul>
</section>
<section id="caution-comp-4">
<h3>caution_comp_4<a class="headerlink" href="#caution-comp-4" title="Link to this heading">¶</a></h3>
<p>Generates an SQL expression in the form <code class="docutils literal notranslate"><span class="pre">(comparison</span> <span class="pre">A</span> <span class="pre">OR</span> <span class="pre">comparison</span> <span class="pre">B</span> <span class="pre">OR</span> <span class="pre">comparison</span> <span class="pre">C)</span> <span class="pre">AND</span> <span class="pre">comparison</span> <span class="pre">D</span></code>.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_c</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_d</span></code> – Type: Object. Required.  Sub-comparisons using any of the comparison feature types documented in this section.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;m_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mbpl&quot;</span><span class="p">,</span> <span class="s2">&quot;mother_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;stepmom&quot;</span><span class="p">,</span> <span class="s2">&quot;momloc&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;caution_comp_4&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;mbpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;mother_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">gt_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;stepmom&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;parent_step_change&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_d</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;momloc&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;present_both_years&quot;</span>
</pre></div>
</div>
</section>
<section id="caution-comp-4-012">
<h3>caution_comp_4_012<a class="headerlink" href="#caution-comp-4-012" title="Link to this heading">¶</a></h3>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">caution_comp_4</span></code>, but first checks the value of comparison D. If comparison D evaluates to false,
then <code class="docutils literal notranslate"><span class="pre">caution_comp_4_012</span></code> evaluates to 2. Otherwise, it evaluates to the result of <code class="docutils literal notranslate"><span class="pre">caution_comp_4</span></code>, so 0 or 1.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all input columns used by sub-comparisons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comp_a</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_b</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_c</span></code>, <code class="docutils literal notranslate"><span class="pre">comp_d</span></code> – Type: Object. Required. Sub-comparisons using any of the comparison feature types documented in this section.</p></li>
</ul>
</li>
</ul>
</section>
<section id="any-equals">
<h3>any_equals<a class="headerlink" href="#any-equals" title="Link to this heading">¶</a></h3>
<p>Used to compare middle initials and first names under specific circumstances.<br />If middle initial A is not empty/null and is the same as either middle initial B or first name B,
OR if first name A is not empty/null and is the same as middle initial B.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. The first input column should be the middle initial column, and the second input column should be the first name column.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;mid_init_match&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namefrst_mid_init&quot;</span><span class="p">,</span> <span class="s2">&quot;namefrst_unstd&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;any_equals&quot;</span>
</pre></div>
</div>
</section>
<section id="either-are-1">
<h3>either_are_1<a class="headerlink" href="#either-are-1" title="Link to this heading">¶</a></h3>
<p>Checks if the column value for either A or B is equal to 1.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Input column to compare to 1.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;either_1&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;nativity&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;either_are_1&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="either-are-0">
<h3>either_are_0<a class="headerlink" href="#either-are-0" title="Link to this heading">¶</a></h3>
<p>Checks if the column value for either A or B is equal to 0.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Input column to compare to 0.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;either_0&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;nativity&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;either_are_0&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="second-gen-imm">
<h3>second_gen_imm<a class="headerlink" href="#second-gen-imm" title="Link to this heading">¶</a></h3>
<p>Checks if individual A is a second-generation immigrant by looking for <code class="docutils literal notranslate"><span class="pre">nativity</span></code> value of 2, 3, or 4 (one or both parents foreign-born).</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Input should be the name of the nativity column.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span>  <span class="s2">&quot;sgen&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;nativity&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;second_gen_imm&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="rel-jaro-winkler">
<h3>rel_jaro_winkler<a class="headerlink" href="#rel-jaro-winkler" title="Link to this heading">¶</a></h3>
<p>Uses a Scala function to determine the number of people in the input column with a name similarity score (Jaro-Winkler) greater than or equal to the given <code class="docutils literal notranslate"><span class="pre">jw_threshold</span></code>, an age difference less than or equal to the given <code class="docutils literal notranslate"><span class="pre">age_threshold</span></code>, and matching sex for the sample A individual and the sample B potential match.  Takes a column generated with the feature selection transform <code class="docutils literal notranslate"><span class="pre">related_individual_rows</span></code> as input (list of person data objects to compare).  Can be used for related or unrelated individuals, depending on the input column specified.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The input column with data in the form of a list of person data objects.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">birthyr_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jw_threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age_threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;rel&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_related_rows&quot;</span>
<span class="n">name_col</span> <span class="o">=</span> <span class="s2">&quot;namefrst_unstd&quot;</span>
<span class="n">birthyr_col</span> <span class="o">=</span> <span class="s2">&quot;replaced_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;rel_jaro_winkler&quot;</span>
<span class="n">jw_threshold</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">age_threshold</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="extra-children">
<h3>extra_children<a class="headerlink" href="#extra-children" title="Link to this heading">¶</a></h3>
<p>Using a Scala function, checks to see if there are children present in sample B who are not present in sample A, but based on relate codes, age, sex, and name, we would have expected to be present in A.  Returns a count of suspected “extra” children.  Takes a column generated with the feature selection transform <code class="docutils literal notranslate"><span class="pre">related_individual_rows</span></code> as input (list of person data objects to compare).</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The input column with data in the form of a list of person data objects.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">relate_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the column with the <code class="docutils literal notranslate"><span class="pre">relate</span></code> code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">histid_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the id column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The name of the column containing the first name for comparison.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">birthyr_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the column containing the birth year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year_b</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. The year that sample B was taken.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jw_threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">float</span></code>.  The minimum acceptable Jaro-Winkler score to consider a match.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age_threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. The maximum acceptable age difference to consider a match.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;extra_children&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_related_rows&quot;</span>
<span class="n">relate_col</span> <span class="o">=</span> <span class="s2">&quot;relate&quot;</span>
<span class="n">histid_col</span> <span class="o">=</span> <span class="s2">&quot;histid&quot;</span>
<span class="n">name_col</span> <span class="o">=</span> <span class="s2">&quot;namefrst_unstd&quot;</span>
<span class="n">birthyr_col</span> <span class="o">=</span> <span class="s2">&quot;replaced_birthyr&quot;</span>
<span class="n">year_b</span> <span class="o">=</span> <span class="mi">1910</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;extra_children&quot;</span>
<span class="n">jw_threshold</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">age_threshold</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="jaro-winkler-rate">
<h3>jaro_winkler_rate<a class="headerlink" href="#jaro-winkler-rate" title="Link to this heading">¶</a></h3>
<p>Uses a Scala function to calculate the percentage of individuals who have a Jaro-Winkler score greater than or equal to the given threshold.  Rate returned as a percentage as a float data type.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The input column with data in the form of a list of person data objects.  The input column seen below (”namelast_neighbors”)was generated using a “neighbor_aggregate” feature selection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jw_threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">float</span></code>. The minimum Jaro-Winkler threshold to consider an acceptable match.</p></li>
</ul>
</li>
</ul>
<p>In the following example, a <code class="docutils literal notranslate"><span class="pre">lower_threshold</span></code> feature add-on is used to convert the returned rate to a boolean asserting whether it meets the given minimum threshold. (&gt;= 5% of neighbors have a Jaro-Winkler score &gt;= 0.95)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;nbors&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;times&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namelast_neighbors&quot;</span><span class="p">,</span> <span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namelast_neighbors&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler_rate&quot;</span>
<span class="n">jw_threshold</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">lower_threshold</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;and&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;county&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
</pre></div>
</div>
</section>
<section id="sum">
<h3>sum<a class="headerlink" href="#sum" title="Link to this heading">¶</a></h3>
<p>Adds the column values for A and B together (takes the sum).</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The input column to be added.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namelast_popularity_sum&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namelast_popularity&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;sum&quot;</span>
</pre></div>
</div>
</section>
<section id="length-b">
<h3>length_b<a class="headerlink" href="#length-b" title="Link to this heading">¶</a></h3>
<p>Returns the length of the column value in record B using the SQL <code class="docutils literal notranslate"><span class="pre">size()</span></code> function.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the input column to take the length of in dataset B.</p></li>
</ul>
</li>
</ul>
</section>
<section id="abs-diff">
<h3>abs_diff<a class="headerlink" href="#abs-diff" title="Link to this heading">¶</a></h3>
<p>Takes the absolute value of the difference between the values of the given column in datasets A and B.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The input column to evaluate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">not_equals</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. OPTIONAL.  You can specify a value for the column to be considered invalid input, in which case the expression would return the value -1 instead of an absolute difference.  For example, if you are evaluating the difference in marriage duration values, and “99” is a placeholder value for “unknown” in the data, you can exclude those values from consideration using this attribute.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;byrdiff&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;replaced_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;mardurmatch&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">not_equals</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">btwn_threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="b-minus-a">
<h3>b_minus_a<a class="headerlink" href="#b-minus-a" title="Link to this heading">¶</a></h3>
<p>Returns the value of subtracting the value of column A from the value of column B.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The input column to evaluate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">not_equals</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. OPTIONAL.  You can specify a value for the column to be considered invalid input, in which case the expression would return the value -1 instead of an absolute difference.  For example, if you are evaluating the difference in marriage duration values, and “99” is a placeholder value for “unknown” in the data, you can exclude those values from consideration using this attribute.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;mardurmatch&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">not_equals</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;b_minus_a&quot;</span>
<span class="n">btwn_threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="geo-distance">
<h3>geo_distance<a class="headerlink" href="#geo-distance" title="Link to this heading">¶</a></h3>
<p>Uses a lookup table to find the geographic distance between locations.  The SQL expression is generated by <code class="docutils literal notranslate"><span class="pre">hlink/linking/core/dist_table.py</span></code>. There are several ways to configure this feature. You can look up distances in the given file using one or two keys (specified with the <code class="docutils literal notranslate"><span class="pre">key_count</span></code> attribute).  You can also optionally have a secondary look-up table that serves as a back-up value in the case that the primary look-up does not contain a value for the locations given.  This is particularly useful for county distance, as you can set the primary join to be across counties, but set up a secondary join on state, which has much fewer combinations and thus less risk of nulls, to fill in when the counties specified aren’t in the look-up.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">key_count</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. The number of keys used to join on the primary (or only) look-up table. Acceptable values are 1 or 2. Ex: for state and county, key_count = 2.  For just state, key_count = 1 even though there is county_a and county_b.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distances_file</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code> of path.  Path to the distances look-up file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  What to name the table that will be generated from the distances file.  If you want to do multiple look-ups, if the table_name is the same across all feature specifications, it will only be read in once.</p></li>
<li><p>Attributes for <code class="docutils literal notranslate"><span class="pre">key_count</span> <span class="pre">=</span> <span class="pre">1</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The column in the input data that you want to use as a key to look up the geographic distance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc_a</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  First column to join on in the look-up table (where to find the value coming from the <code class="docutils literal notranslate"><span class="pre">column_name</span></code> column A).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc_b</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Second column to join on in the look-up table (where to find the value coming from the <code class="docutils literal notranslate"><span class="pre">column_name</span></code> column B).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Name of the column containing the geographic distance in the look-up table.</p></li>
</ul>
</li>
<li><p>Attributes for <code class="docutils literal notranslate"><span class="pre">key_count</span> <span class="pre">=</span> <span class="pre">2</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings.  The two columns you want to use as keys to look up the geographic distance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_column_a</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. First column to join on in the source data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_column_b</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Second column to join on in the source data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc_a_0</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  First column to join on in the look-up table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc_a_1</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  First column to join on in the look-up table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc_b_0</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Second column to join on in the look-up table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc_b_1</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Second column to join on in the look-up table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Name of the column containing the geographic distance in the look-up table.</p></li>
</ul>
</li>
<li><p>Attributes if using a secondary join:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_key_count</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. The number of keys used to join on the secondary (backup) look-up table. Acceptable values are 1 or 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_table_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  What to name the table that will be generated from the <code class="docutils literal notranslate"><span class="pre">secondary_distances_file</span></code>.  If you want to do multiple look-ups, if the table_name is the same across all feature specifications, it will only be read in once.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_distances_file</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code> of path.  Path to the secondary distances look-up file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_source_column</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The column in the input data that you want to use as a key in the secondary geographic distance look-up.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_loc_a</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. First column to join on in the secondary look-up table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_loc_b</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Second column to join on in the secondary look-up table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_distance_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Name of the column containing the geographic distance in the secondary look-up table.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;state_distance&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;geo_distance&quot;</span>
<span class="n">key_count</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;state_distance_lookup&quot;</span>
<span class="n">distances_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/county_state_distance.csv&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;bpl&quot;</span>
<span class="n">loc_a</span> <span class="o">=</span> <span class="s2">&quot;statecode1&quot;</span>
<span class="n">loc_b</span> <span class="o">=</span> <span class="s2">&quot;statecode2&quot;</span>
<span class="n">distance_col</span> <span class="o">=</span> <span class="s2">&quot;dist&quot;</span>


<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;county_distance&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;geo_distance&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="n">key_count</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;county_distance_lookup&quot;</span>
<span class="n">distances_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/county_1900_1910_distances_km.csv&quot;</span>
<span class="c1"># columns to join on in the data</span>
<span class="n">source_column_a</span> <span class="o">=</span> <span class="s2">&quot;county&quot;</span>
<span class="n">source_column_b</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>

<span class="c1"># column names from the csv lookup file</span>
<span class="n">loc_a_0</span> <span class="o">=</span> <span class="s2">&quot;from_icpsrctyi&quot;</span>
<span class="n">loc_a_1</span> <span class="o">=</span> <span class="s2">&quot;to_icpsrctyi&quot;</span>
<span class="n">loc_b_0</span> <span class="o">=</span> <span class="s2">&quot;from_statefip&quot;</span>
<span class="n">loc_b_1</span> <span class="o">=</span> <span class="s2">&quot;to_statefip&quot;</span>
<span class="n">distance_col</span> <span class="o">=</span> <span class="s2">&quot;distance_km&quot;</span>

<span class="c1"># SECONDARY JOIN</span>
<span class="n">secondary_key_count</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">secondary_table_name</span> <span class="o">=</span> <span class="s2">&quot;state_distance_lookup&quot;</span>
<span class="n">secondary_distances_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/state_1900_1910_distances_km.csv&quot;</span>
<span class="n">secondary_source_column</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">secondary_loc_a</span> <span class="o">=</span> <span class="s2">&quot;from_statefip&quot;</span>
<span class="n">secondary_loc_b</span> <span class="o">=</span> <span class="s2">&quot;to_statefip&quot;</span>
<span class="n">secondary_distance_col</span> <span class="o">=</span> <span class="s2">&quot;distance_km&quot;</span>
</pre></div>
</div>
</section>
<section id="fetch-a">
<h3>fetch_a<a class="headerlink" href="#fetch-a" title="Link to this heading">¶</a></h3>
<p>Gets the value of column A.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The column to get the value from.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;race&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;race&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;fetch_a&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="fetch-b">
<h3>fetch_b<a class="headerlink" href="#fetch-b" title="Link to this heading">¶</a></h3>
<p>Gets the value of column B.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The column to get the value from.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;race&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;race&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;fetch_b&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="present-both-years">
<h3>present_both_years<a class="headerlink" href="#present-both-years" title="Link to this heading">¶</a></h3>
<p>Checks whether column A and column B are both present and both positive (&gt; 0).
Evaluates to 1 if both are present and positive and 0 otherwise.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The column to check. Must be a column with a numerical type.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;sp_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spouse_bpl&quot;</span><span class="p">,</span> <span class="s2">&quot;spouse_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;durmarr&quot;</span><span class="p">,</span> <span class="s2">&quot;sploc&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;caution_comp_4&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_bpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">gt_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;new_marr&quot;</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="mi">7</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_d</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;sploc&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;present_both_years&quot;</span>
</pre></div>
</div>
</section>
<section id="neither-are-null">
<h3>neither_are_null<a class="headerlink" href="#neither-are-null" title="Link to this heading">¶</a></h3>
<p>Checks that neither column A nor column B is null or the empty string <code class="docutils literal notranslate"><span class="pre">''</span></code>.
Evaluates to 1 if neither column is null or <code class="docutils literal notranslate"><span class="pre">''</span></code> and evaluates to 0 otherwise.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The column of type string to check.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;mpres&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;m_namefrst&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;neither_are_null&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="present-and-matching-categorical">
<h3>present_and_matching_categorical<a class="headerlink" href="#present-and-matching-categorical" title="Link to this heading">¶</a></h3>
<p>Checks that both column A and column B are present and that they match according to SQL’s <code class="docutils literal notranslate"><span class="pre">IS</span> <span class="pre">DISTINCT</span> <span class="pre">FROM</span></code>. Evaluates to 0, 1, or 2:</p>
<p>0 → columns are both present and match</p>
<p>1 → columns are both present but are distinct</p>
<p>2 → one or both columns are missing</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The column to check.</p></li>
</ul>
</li>
</ul>
</section>
<section id="present-and-not-equal">
<h3>present_and_not_equal<a class="headerlink" href="#present-and-not-equal" title="Link to this heading">¶</a></h3>
<p>Checks that column A and column B are both present but are not equal.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The column to check.</p></li>
</ul>
</li>
</ul>
</section>
<section id="present-and-equal-categorical-in-universe">
<h3>present_and_equal_categorical_in_universe<a class="headerlink" href="#present-and-equal-categorical-in-universe" title="Link to this heading">¶</a></h3>
<p>Checks that column A and column B are both present, are not equal to the not-in-universe value NIU,
and are equal to each other according to SQL’s <code class="docutils literal notranslate"><span class="pre">IS</span> <span class="pre">DISTINCT</span> <span class="pre">FROM</span></code>. Evaluates to 0 if either column is missing or
if either column is the NIU value. Otherwise, evaluates to 0 if the columns are distinct or 1 if
the columns are equal.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The column to check.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NIU</span></code> – Type: same as the type of the input column. Required. The not-in-universe value to use in the check.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;mfbplmatch&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;nativity&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;present_and_equal_categorical_in_universe&quot;</span>
<span class="n">NIU</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="multi-jaro-winkler-search">
<h3>multi_jaro_winkler_search<a class="headerlink" href="#multi-jaro-winkler-search" title="Link to this heading">¶</a></h3>
<p>This is a specialized comparison feature that simplifies particular ways of searching
multiple columns for Jaro-Winkler similarity with additional constraints on some
other columns. It does Jaro-Winkler and equality comparisons on a variable number
<code class="docutils literal notranslate"><span class="pre">num_cols</span></code> of columns whose names can be templated with the numbers 1, 2, …, <code class="docutils literal notranslate"><span class="pre">num_cols</span></code>.</p>
<p>It takes a number of columns and templates for generating the column names. For
each combination (M, N) in the Cartesian product {1, 2, …, <code class="docutils literal notranslate"><span class="pre">num_cols</span></code>} ×
{1, 2, …, <code class="docutils literal notranslate"><span class="pre">num_cols</span></code>}, it…</p>
<ol class="simple">
<li><p>Generates two column names per template by replacing the string <code class="docutils literal notranslate"><span class="pre">{n}</span></code> in the given templates
with the current column numbers M and N, respectively.</p></li>
<li><p>Compares the columns generated by <code class="docutils literal notranslate"><span class="pre">jw_col_template</span></code> with the <code class="docutils literal notranslate"><span class="pre">jw</span></code> function and
checks if the similarity between the columns is at least <code class="docutils literal notranslate"><span class="pre">jw_threshold</span></code>.</p></li>
<li><p>Compares each pair of columns generated by <code class="docutils literal notranslate"><span class="pre">equal_and_not_null_templates</span></code> to see if they
are equal and neither are null.</p></li>
<li><p>Takes the AND of all comparisons in steps 2 and 3, which is the final result
for this (M, N) combination.</p></li>
</ol>
<p>After this comparison feature has computed step 4 for each combination, it returns
1 if any step 4 returned 1, or 0 if all of the step 4s are 0.</p>
<p>For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;multi_jaro_winkler_search&quot;</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">jw_col_template</span> <span class="o">=</span> <span class="s2">&quot;s</span><span class="si">{n}</span><span class="s2">_namefrst&quot;</span>
<span class="n">jw_threshold</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">equal_and_not_null_templates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s</span><span class="si">{n}</span><span class="s2">_bpl&quot;</span><span class="p">,</span> <span class="s2">&quot;s</span><span class="si">{n}</span><span class="s2">_sex&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>does 25 comparisons. For each (M, N) in the Cartesian product {1, 2, 3, 4, 5}
× {1, 2, 3, 4, 5}, it computes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jw</span><span class="p">(</span><span class="n">nvl</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sM_namefrst</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">nvl</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">sN_namefrst</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.7</span> <span class="n">AND</span>
<span class="n">a</span><span class="o">.</span><span class="n">sM_bpl</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span> <span class="n">AND</span>
<span class="n">b</span><span class="o">.</span><span class="n">sN_bpl</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span> <span class="n">AND</span>
<span class="n">a</span><span class="o">.</span><span class="n">sM_bpl</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">sN_bpl</span> <span class="n">AND</span>
<span class="n">a</span><span class="o">.</span><span class="n">sM_sex</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span> <span class="n">AND</span>
<span class="n">b</span><span class="o">.</span><span class="n">sN_sex</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span> <span class="n">AND</span>
<span class="n">a</span><span class="o">.</span><span class="n">sM_sex</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">sN_sex</span>
</pre></div>
</div>
<p>It returns 1 if any of these expressions evaluate to 1, and 0 if all of them
evaluate to 0.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">num_cols</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">integer</span></code>. Required. The number of columns being compared.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jw_col_template</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The template for the columns
to be compared with Jaro-Winkler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jw_threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">float</span></code>. Required. The minimum Jaro-Winkler score
required for the comparison to pass.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">equal_and_not_null_templates</span></code> – Type: list of strings. Optional, defaults to
the empty list. The templates for the columns to be compared for equality.
If one or both of the columns are NULL, they are considered not to be equal.</p></li>
</ul>
</li>
</ul>
</section>
<section id="sql-condition">
<h3>sql_condition<a class="headerlink" href="#sql-condition" title="Link to this heading">¶</a></h3>
<p>This is a flexible comparison type that allows users to write their own SQL expressions to be
evaluated. Favor using a different comparison type if that’s a reasonable option. If there are
no other comparison types that work for a particular use case, this one is a good fallback.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_names</span></code> – Type: list of strings. Required. A list of all columns used in the SQL expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The SQL expression to evaluate.</p></li>
</ul>
</li>
</ul>
<p>In this example, we make use of the hlink-defined <code class="docutils literal notranslate"><span class="pre">jw</span></code> function, which computes
the Jaro-Winkler similarity of two strings. <code class="docutils literal notranslate"><span class="pre">nvl</span></code> is a Spark builtin function
which returns its second argument if the first is null, and the first argument
otherwise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namelast_jw_max&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;sql_condition&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namelast1&quot;</span><span class="p">,</span> <span class="s2">&quot;namelast2&quot;</span><span class="p">,</span> <span class="s2">&quot;namelast3&quot;</span><span class="p">]</span>
<span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;GREATEST(jw(nvl(a.namelast1, &#39;&#39;), nvl(b.namelast1, &#39;&#39;)), jw(nvl(a.namelast2, &#39;&#39;), nvl(b.namelast2, &#39;&#39;)), jw(nvl(a.namelast3, &#39;&#39;), nvl(b.namelast3, &#39;&#39;)))&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="feature-add-ons">
<h2>Feature add-ons<a class="headerlink" href="#feature-add-ons" title="Link to this heading">¶</a></h2>
<p>These attributes can be added to most comparison feature types above to extend the type of output returned beyond the standard comparison feature.</p>
<section id="alias">
<h3>alias<a class="headerlink" href="#alias" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">alias</span></code>: Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Should be used at the top level comparison of every comparison feature.  The name for the output column.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;jw_f&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;father_namefrst&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>
</pre></div>
</div>
</section>
<section id="power">
<h3>power<a class="headerlink" href="#power" title="Link to this heading">¶</a></h3>
<p>Raises a comparison feature to a given exponential power.</p>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">power</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">int</span></code>. The power to raise the comparison output to.  For example, <code class="docutils literal notranslate"><span class="pre">power</span> <span class="pre">=</span> <span class="pre">2</span></code> will square the output.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;county_distance_squared&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;geo_distance&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="c1"># PRIMARY JOIN</span>
<span class="c1"># key count: the number of keys used for the join per source file.  Ex: for state and county, key_count = 2.  For just state, key_count = 1 even though there is county_a and county_b</span>
<span class="n">key_count</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;county_distance_lookup&quot;</span>
<span class="c1">#distances_file = &quot;/path/to/county_state_distance.csv&quot;</span>
<span class="n">distances_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/county_1900_1910_distances_km.csv&quot;</span>
<span class="c1"># columns to join on in the data</span>
<span class="n">source_column_a</span> <span class="o">=</span> <span class="s2">&quot;county&quot;</span>
<span class="n">source_column_b</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="c1"># column names from the csv lookup file</span>
<span class="n">loc_a_0</span> <span class="o">=</span> <span class="s2">&quot;from_icpsrctyi&quot;</span>
<span class="n">loc_a_1</span> <span class="o">=</span> <span class="s2">&quot;to_icpsrctyi&quot;</span>
<span class="n">loc_b_0</span> <span class="o">=</span> <span class="s2">&quot;from_statefip&quot;</span>
<span class="n">loc_b_1</span> <span class="o">=</span> <span class="s2">&quot;to_statefip&quot;</span>
<span class="n">distance_col</span> <span class="o">=</span> <span class="s2">&quot;distance_km&quot;</span>
<span class="c1"># SECONDARY JOIN</span>
<span class="n">secondary_key_count</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">secondary_table_name</span> <span class="o">=</span> <span class="s2">&quot;state_distance_lookup&quot;</span>
<span class="n">secondary_distances_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/state_1900_1910_distances_km.csv&quot;</span>
<span class="n">secondary_source_column</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">secondary_loc_a</span> <span class="o">=</span> <span class="s2">&quot;from_statefip&quot;</span>
<span class="n">secondary_loc_b</span> <span class="o">=</span> <span class="s2">&quot;to_statefip&quot;</span>
<span class="n">secondary_distance_col</span> <span class="o">=</span> <span class="s2">&quot;distance_km&quot;</span>
<span class="n">power</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="threshold">
<h3>threshold<a class="headerlink" href="#threshold" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code> – Type: numeric types. Asserts if the comparison feature output is not null and is greater than or equal to (<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>) the given threshold value.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;imm&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;nativity&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;fetch_a&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="lower-threshold">
<h3>lower_threshold<a class="headerlink" href="#lower-threshold" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lower_threshold</span></code> – Type: numeric types.  Asserts if the comparison feature output is not null and is greater than or equal to (<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>) the given threshold value.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;street_jw&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;times&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;street&quot;</span><span class="p">,</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;street&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>
<span class="n">lower_threshold</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;and&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county&quot;</span><span class="p">,</span> <span class="s2">&quot;statefip&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;county&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
</pre></div>
</div>
</section>
<section id="upper-threshold">
<h3>upper_threshold<a class="headerlink" href="#upper-threshold" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">upper_threshold</span></code> – Type: numeric types.  Asserts if the comparison feature output is not null and is less than or equal to (<code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>) the given threshold value.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;sp_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spouse_bpl&quot;</span><span class="p">,</span> <span class="s2">&quot;spouse_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;durmarr&quot;</span><span class="p">,</span> <span class="s2">&quot;sploc&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;caution_comp_4&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_bpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">gt_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;new_marr&quot;</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="mi">7</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_d</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;sploc&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;present_both_years&quot;</span>
</pre></div>
</div>
</section>
<section id="gt-threshold">
<h3>gt_threshold<a class="headerlink" href="#gt-threshold" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">gt_threshold</span></code> – Type: numeric types.  Asserts if the comparison feature output is not null and is greater than (<code class="docutils literal notranslate"><span class="pre">&gt;</span></code>) the given threshold value.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;sp_caution&quot;</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spouse_bpl&quot;</span><span class="p">,</span> <span class="s2">&quot;spouse_birthyr&quot;</span><span class="p">,</span> <span class="s2">&quot;durmarr&quot;</span><span class="p">,</span> <span class="s2">&quot;sploc&quot;</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;caution_comp_4&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_bpl&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;not_equals&quot;</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;spouse_birthyr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">gt_threshold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_c</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;new_marr&quot;</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="mi">7</span>
<span class="p">[</span><span class="n">comparison_features</span><span class="o">.</span><span class="n">comp_d</span><span class="p">]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;sploc&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;present_both_years&quot;</span>
</pre></div>
</div>
</section>
<section id="btwn-threshold">
<h3>btwn_threshold<a class="headerlink" href="#btwn-threshold" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">btwn_threshold</span></code> – Type: List of numeric type.  Asserts if the comparison feature output is greater than or equal to (<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>) the first threshold value, and less than or equal to (<code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>) the second threshold value.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;mardurmatch&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">not_equals</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;b_minus_a&quot;</span>
<span class="n">btwn_threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="look-at-addl-var">
<h3>look_at_addl_var<a class="headerlink" href="#look-at-addl-var" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">look_at_addl_var</span></code> – Type: boolean. Flags the program to consider an additional column value before reporting the comparison feature value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">addl_var</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The additional column to consider.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_val_expr</span></code> – Type: expression.  The expression to use to evaluate the additional column.  For example, <code class="docutils literal notranslate"><span class="pre">check_val_expr</span> <span class="pre">=</span> <span class="pre">&quot;=</span> <span class="pre">5&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">else_val</span></code> – Type: same type as comparison feature output.  If the additional volumn value does not meet the <code class="docutils literal notranslate"><span class="pre">check_val_expr</span></code> specification, the value to return instead of the comparison feature value.</p></li>
</ul>
</li>
</ul>
<p>In the following example, the generated SQL expression for the column would be: <code class="docutils literal notranslate"><span class="pre">CASE</span> <span class="pre">WHEN</span> <span class="pre">{datasource}.nativity</span> <span class="pre">=</span> <span class="pre">5</span> <span class="pre">then</span> <span class="pre">{yrimmig</span> <span class="pre">abs_diff</span> <span class="pre">value}</span> <span class="pre">else</span> <span class="pre">-1</span> <span class="pre">END</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;immyear_diff&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;yrimmig&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;abs_diff&quot;</span>
<span class="n">look_at_addl_var</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">addl_var</span> <span class="o">=</span> <span class="s2">&quot;nativity&quot;</span>
<span class="n">datasource</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="n">check_val_expr</span> <span class="o">=</span> <span class="s2">&quot;= 5&quot;</span>
<span class="n">else_val</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="aggregate-features">
<h2>Aggregate Features<a class="headerlink" href="#aggregate-features" title="Link to this heading">¶</a></h2>
<p>These features are not configurable.  To include them in the generated comparison features, they just need to be included in the <code class="docutils literal notranslate"><span class="pre">[training][independent_vars]</span></code> section of the config.  They are generated using the “aggregate_features” SQL template.</p>
<section id="hits">
<h3>hits<a class="headerlink" href="#hits" title="Link to this heading">¶</a></h3>
<p>The number of potential matches generated for the given individual (counted by aggregating on <code class="docutils literal notranslate"><span class="pre">{id_column}_a</span></code>).</p>
</section>
<section id="hits2">
<h3>hits2<a class="headerlink" href="#hits2" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hits</span></code> squared.</p>
</section>
<section id="exact-mult">
<h3>exact_mult<a class="headerlink" href="#exact-mult" title="Link to this heading">¶</a></h3>
<p>Indicator for the existence of multiple potential matches with the exact same first and last name as the A sample individual within the B data.  Returns numeric boolean (0 or 1).</p>
</section>
</section>
<section id="household-aggregate-features">
<h2>Household Aggregate Features<a class="headerlink" href="#household-aggregate-features" title="Link to this heading">¶</a></h2>
<p>These features are not configurable.  To include them in the generated comparison features, they just need to be included in the <code class="docutils literal notranslate"><span class="pre">[hh_training][independent_vars]</span></code> section of the config.  They are generated using the “hh_aggregate_features” SQL template.</p>
<section id="jw-max-a">
<h3>jw_max_a<a class="headerlink" href="#jw-max-a" title="Link to this heading">¶</a></h3>
<p>The highest Jaro-Winkler score for any of the first names in linked household A against the first name in linked household B where birth year difference is less than or equal to ten, excluding the individual A in the current potential match.  Returns <code class="docutils literal notranslate"><span class="pre">0</span></code> if no other individuals are in the household for comparison.</p>
</section>
<section id="jw-max-b">
<h3>jw_max_b<a class="headerlink" href="#jw-max-b" title="Link to this heading">¶</a></h3>
<p>The highest Jaro-Winkler score for any of the first names in linked household A against the first name in linked household B where sex matches and birth year difference is less than or equal to ten, excluding the individual A in the current potential match.  Returns <code class="docutils literal notranslate"><span class="pre">0</span></code> if no other individuals are in the household for comparison.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">hlink</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="link_tasks.html">Link Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_the_program.html">Running hlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_examples.html">Advanced Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="column_mappings.html">Column Mappings</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparisons.html">Comparisons</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Comparison Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#comparison-types">Comparison Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#feature-add-ons">Feature add-ons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aggregate-features">Aggregate Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#household-aggregate-features">Household Aggregate Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="feature_selection_transforms.html">Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline_features.html">Pipeline Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="substitutions.html">Substitutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_exploration.html">Model Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="comparisons.html" title="previous chapter">Comparisons</a></li>
      <li>Next: <a href="feature_selection_transforms.html" title="next chapter">Feature Selection Transforms</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019-2025, IPUMS.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/comparison_features.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>