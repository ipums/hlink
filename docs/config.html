
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Configuration &#8212; hlink 3.5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Column mapping transforms" href="column_mapping_transforms.html" />
    <link rel="prev" title="Advanced Workflow Examples" href="use_examples.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h1>
<ol class="simple">
<li><p><a class="reference external" href="#basic-config-file">Basic Example Config File</a></p></li>
<li><p><a class="reference external" href="#advanced-config-file">Advanced Example Config File</a></p></li>
<li><p><a class="reference external" href="#top-level-configs">Top level configs</a></p></li>
<li><p><a class="reference external" href="#data-sources">Data sources</a></p></li>
<li><p><a class="reference external" href="#filter">Filter</a></p></li>
<li><p><a class="reference external" href="#column-mappings">Column mappings</a></p></li>
<li><p><a class="reference external" href="#substitution-columns">Substitution columns</a></p></li>
<li><p><a class="reference external" href="#feature-selections">Feature selections</a></p></li>
<li><p><a class="reference external" href="#potential-matches-universe">Potential matches universe</a></p></li>
<li><p><a class="reference external" href="#blocking">Blocking</a></p></li>
<li><p><a class="reference external" href="#comparisons">Comparisons</a></p></li>
<li><p><a class="reference external" href="#household-comparisons">Household comparisons</a></p></li>
<li><p><a class="reference external" href="#comparison-features">Comparison features</a></p></li>
<li><p><a class="reference external" href="#pipeline-generated-features">Pipeline-generated features</a></p></li>
<li><p><a class="reference external" href="#training-and-models">Training and models</a></p></li>
<li><p><a class="reference external" href="#household-training-and-models">Household training and models</a></p></li>
</ol>
<section id="basic-config-file">
<h2>Basic Config File<a class="headerlink" href="#basic-config-file" title="Permalink to this heading">¶</a></h2>
<p>The config file tells the hlink program what to link and how to link it. A description of the different sections of
a configuration file are below. For reference, here is an example of a relatively basic config file. This config file
is used by the <code class="docutils literal notranslate"><span class="pre">examples/tutorial/tutorial.py</span></code> script for linking, and there is a more detailed discussion of the config
file in the README in <code class="docutils literal notranslate"><span class="pre">examples/tutorial</span></code>.</p>
<p>Note that this config is written in TOML, but hlink is also able to work with JSON config files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">id_column</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span>

<span class="p">[</span><span class="n">datasource_a</span><span class="p">]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;data/A.csv&quot;</span>

<span class="p">[</span><span class="n">datasource_b</span><span class="p">]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;data/B.csv&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;NAMEFRST&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;lowercase_strip&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;NAMELAST&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;lowercase_strip&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;AGE&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;add_to_a&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;SEX&quot;</span>

<span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;SEX&quot;</span>

<span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;AGE_2&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="n">derived_from</span> <span class="o">=</span> <span class="s2">&quot;AGE&quot;</span>
<span class="n">expand_length</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">explode</span> <span class="o">=</span> <span class="n">true</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;NAMEFRST_JW&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;NAMEFRST&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;NAMELAST_JW&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;NAMELAST&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>

<span class="p">[</span><span class="n">comparisons</span><span class="p">]</span>
<span class="n">operator</span> <span class="o">=</span> <span class="s2">&quot;AND&quot;</span>

<span class="p">[</span><span class="n">comparisons</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;NAMEFRST_JW&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.79</span>

<span class="p">[</span><span class="n">comparisons</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;NAMELAST_JW&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.84</span>
</pre></div>
</div>
</section>
<section id="advanced-config-file">
<h2>Advanced Config File<a class="headerlink" href="#advanced-config-file" title="Permalink to this heading">¶</a></h2>
<p>Here is an example of a more complex config file that makes use of more of hlink’s features.
It uses machine learning to probabilistically link the two datasets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">id_column</span> <span class="o">=</span> <span class="s2">&quot;histid&quot;</span>
<span class="n">drop_data_from_scored_matches</span> <span class="o">=</span> <span class="n">false</span>

<span class="c1"># --------- DATASOURCES --------------</span>
<span class="p">[</span><span class="n">datasource_a</span><span class="p">]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;us1900&quot;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/us1900m_usa.P.parquet&quot;</span>

<span class="p">[</span><span class="n">datasource_b</span><span class="p">]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;us1910&quot;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/us1910m_usa.P.parquet&quot;</span>

<span class="c1"># --------- FILTERS --------------</span>

<span class="p">[[</span><span class="nb">filter</span><span class="p">]]</span>
<span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;NAMELAST is not null and NAMELAST != &#39;&#39;&quot;</span>

<span class="p">[[</span><span class="nb">filter</span><span class="p">]]</span>
<span class="n">training_data_subset</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">datasource</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>

<span class="p">[[</span><span class="nb">filter</span><span class="p">]]</span>
<span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;age &gt;= 5&quot;</span>
<span class="n">datasource</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>

<span class="c1"># --------- COLUMN MAPPINGS --------------</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;serialp&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;age&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namelast&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_clean&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;lowercase_strip&quot;</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;rationalize_name_words&quot;</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;remove_qmark_hyphen&quot;</span><span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;replace_apostrophe&quot;</span><span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;remove_suffixes&quot;</span><span class="p">,</span>  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;jr&quot;</span><span class="p">,</span> <span class="s2">&quot;sr&quot;</span><span class="p">,</span> <span class="s2">&quot;ii&quot;</span><span class="p">,</span> <span class="s2">&quot;iii&quot;</span><span class="p">]</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;remove_alternate_names&quot;</span><span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;condense_strip_whitespace&quot;</span><span class="p">},</span>
<span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_split&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_clean&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;split&quot;</span> <span class="p">}</span> <span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_std&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_split&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;array_index&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">}</span>
<span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;bpl_orig&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;bpl&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;divide_by_int&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;get_floor&quot;</span> <span class="p">}</span>
<span class="p">]</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;statefip&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;statefip_h&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;birthyr&quot;</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;clean_birthyr&quot;</span>
<span class="p">[[</span><span class="n">column_mappings</span><span class="o">.</span><span class="n">transforms</span><span class="p">]]</span>
<span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;mapping&quot;</span>
<span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span><span class="mi">9999</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">1999</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
<span class="n">output_type</span> <span class="o">=</span> <span class="s2">&quot;int&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;relate_div_100&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;relate&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;divide_by_int&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;get_floor&quot;</span> <span class="p">}</span>
<span class="p">]</span>

<span class="c1"># --------- SUBSTITUTIONS --------------</span>

<span class="p">[[</span><span class="n">substitution_columns</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_std&quot;</span>

<span class="p">[[</span><span class="n">substitution_columns</span><span class="o">.</span><span class="n">substitutions</span><span class="p">]]</span>
<span class="n">join_column</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>
<span class="n">join_value</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
<span class="n">substitution_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/name_std/male.csv&quot;</span>

<span class="p">[[</span><span class="n">substitution_columns</span><span class="o">.</span><span class="n">substitutions</span><span class="p">]]</span>
<span class="n">join_column</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>
<span class="n">join_value</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
<span class="n">substitution_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/name_std/female.csv&quot;</span>

<span class="c1"># --------- FEATURE SELECTIONS --------------</span>

<span class="p">[[</span><span class="n">feature_selections</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;clean_birthyr&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;replaced_birthyr&quot;</span>
<span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;case when clean_birthyr is null or clean_birthyr == &#39;&#39; then year - age else clean_birthyr end&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;sql_condition&quot;</span>

<span class="p">[[</span><span class="n">feature_selections</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;namelast&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;namelast_bigrams&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;bigrams&quot;</span>

<span class="p">[[</span><span class="n">feature_selections</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;bpl_orig&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;bpl_clean&quot;</span>
<span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;case when bpl_str == &#39;washington&#39; and bpl2_str==&#39;washington&#39; then 53 when (bpl_str is null or bpl_str == &#39;&#39;) and bpl2_str==&#39;washington&#39; then 53 when bpl_str == &#39;washington&#39; and (bpl2_str==&#39;&#39; or bpl2_str is null) then 53 else bpl_orig end&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;sql_condition&quot;</span>

<span class="p">[[</span><span class="n">feature_selections</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;bpl_clean&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;region&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;attach_variable&quot;</span>
<span class="n">region_dict</span> <span class="o">=</span> <span class="s2">&quot;/path/to/region.csv&quot;</span>
<span class="n">col_to_join_on</span> <span class="o">=</span> <span class="s2">&quot;bpl&quot;</span>
<span class="n">col_to_add</span> <span class="o">=</span> <span class="s2">&quot;region&quot;</span>
<span class="n">null_filler</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">col_type</span> <span class="o">=</span> <span class="s2">&quot;float&quot;</span>

<span class="c1"># --------- POTENTIAL MATCHES UNIVERSE -------------</span>

<span class="p">[[</span><span class="n">potential_matches_universe</span><span class="p">]]</span>
<span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;sex == 1&quot;</span>

<span class="c1"># --------- BLOCKING --------------</span>

<span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>

<span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;birthyr_3&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="n">derived_from</span> <span class="o">=</span> <span class="s2">&quot;replaced_birthyr&quot;</span>
<span class="n">expand_length</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">explode</span> <span class="o">=</span> <span class="n">true</span>

<span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namelast_bigrams&quot;</span>
<span class="n">explode</span> <span class="o">=</span> <span class="n">true</span>

<span class="c1"># --------- COMPARISONS --------------</span>

<span class="p">[</span><span class="n">comparisons</span><span class="p">]</span>
<span class="n">operator</span> <span class="o">=</span> <span class="s2">&quot;AND&quot;</span>

<span class="p">[</span><span class="n">comparisons</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_std_jw&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="p">[</span><span class="n">comparisons</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;namelast_jw&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.75</span>

<span class="c1"># --------- HOUSEHOLD COMPARISIONS (post-blocking filters) -------------</span>

<span class="p">[</span><span class="n">hh_comparisons</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;byrdiff&quot;</span>
<span class="n">threshold_expr</span> <span class="o">=</span> <span class="s2">&quot;&lt;= 10&quot;</span>

<span class="c1"># --------- COMPARISON FEATURES --------------</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;region&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;region&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;fetch_a&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_std_jw&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_std&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namelast_jw&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namelast&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;sex_equals&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;relate_a&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;relate_div_100&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;fetch_a&quot;</span>

<span class="c1"># --------- PIPELINE-GENERATED FEATURES ------------</span>

<span class="p">[[</span><span class="n">pipeline_features</span><span class="p">]]</span>
<span class="n">input_columns</span> <span class="o">=</span>  <span class="p">[</span><span class="s2">&quot;sex_equals&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">]</span>
<span class="n">output_column</span> <span class="o">=</span>  <span class="s2">&quot;sex_region_interaction&quot;</span>
<span class="n">transformer_type</span> <span class="o">=</span>  <span class="s2">&quot;interaction&quot;</span>

<span class="p">[[</span><span class="n">pipeline_features</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;relate_a&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;relatetype&quot;</span>
<span class="n">transformer_type</span> <span class="o">=</span> <span class="s2">&quot;bucketizer&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9999</span><span class="p">]</span>

<span class="c1"># --------- TRAINING --------------</span>

<span class="p">[</span><span class="n">training</span><span class="p">]</span>

<span class="n">independent_vars</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;namelast_jw&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;hits&quot;</span><span class="p">,</span> <span class="s2">&quot;sex_region_interaction&quot;</span><span class="p">,</span> <span class="s2">&quot;relatetype&quot;</span><span class="p">]</span>
<span class="n">scale_data</span> <span class="o">=</span> <span class="n">false</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;/path/to/training_data.csv&quot;</span>
<span class="n">dependent_var</span> <span class="o">=</span> <span class="s2">&quot;match&quot;</span>
<span class="n">score_with_model</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">use_training_data_features</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">split_by_id_a</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">decision</span> <span class="o">=</span> <span class="s2">&quot;drop_duplicate_with_threshold_ratio&quot;</span>

<span class="n">n_training_iterations</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">output_suspicious_TD</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">model_parameters</span> <span class="o">=</span> <span class="p">[</span> 
    <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="n">maxDepth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">numTrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="n">threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">],</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">],</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span> <span class="p">}</span>
<span class="p">]</span>
    
<span class="n">chosen_model</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">}</span>

<span class="c1"># --------- HOUSEHOLD TRAINING --------------</span>

<span class="p">[</span><span class="n">hh_training</span><span class="p">]</span>

<span class="n">prediction_col</span> <span class="o">=</span> <span class="s2">&quot;prediction&quot;</span>
<span class="n">hh_col</span> <span class="o">=</span> <span class="s2">&quot;serialp&quot;</span>

<span class="n">independent_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namelast_jw&quot;</span><span class="p">,</span> <span class="s2">&quot;namefrst_std_jw&quot;</span><span class="p">,</span> <span class="s2">&quot;relatetype&quot;</span><span class="p">,</span> <span class="s2">&quot;sex_equals&quot;</span><span class="p">]</span>
<span class="n">scale_data</span> <span class="o">=</span> <span class="n">false</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;/path/to/hh_training_data_1900_1910.csv&quot;</span>
<span class="n">dependent_var</span> <span class="o">=</span> <span class="s2">&quot;match&quot;</span>
<span class="n">score_with_model</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">use_training_data_features</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">split_by_id_a</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">decision</span> <span class="o">=</span> <span class="s2">&quot;drop_duplicate_with_threshold_ratio&quot;</span>

<span class="n">n_training_iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">output_suspicious_TD</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">model_parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="n">maxDepth</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">numTrees</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;probit&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">}</span>
<span class="p">]</span>
    
<span class="n">chosen_model</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="top-level-configs">
<h2>Top level configs<a class="headerlink" href="#top-level-configs" title="Permalink to this heading">¶</a></h2>
<p>These configs should go at the top of your config file under no header:</p>
<p><em>id_column</em></p>
<p>Required.  Specify the id column that uniquely identifies a record in each dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">id_column</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span>
</pre></div>
</div>
<p><em>drop_data_from_scored_matches</em></p>
<p>Optional.  Whether or not the scored potential matches should be output with full features data, or just ids and match information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">drop_data_from_scored_matches</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
</section>
<section id="data-sources">
<h2>Data sources<a class="headerlink" href="#data-sources" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header names: <code class="docutils literal notranslate"><span class="pre">datasource_a</span></code>, <code class="docutils literal notranslate"><span class="pre">datasource_b</span></code></p></li>
<li><p>Description: Specifies your input data.</p></li>
<li><p>Required: True</p></li>
<li><p>Type: Object</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">alias</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The short name for the datasource. Must be alphanumeric with no spaces.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The path to the input file. The file can be <code class="docutils literal notranslate"><span class="pre">csv</span></code> or <code class="docutils literal notranslate"><span class="pre">parquet</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">convert_ints_to_longs</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. Optional. If set to true, automatically
convert each column with type <code class="docutils literal notranslate"><span class="pre">int</span></code> in the input file to type <code class="docutils literal notranslate"><span class="pre">long</span></code>. This can be
especially useful when reading from CSV files, as Spark may assume that columns are
type <code class="docutils literal notranslate"><span class="pre">int</span></code> when they should be <code class="docutils literal notranslate"><span class="pre">long</span></code>. Parquet files have their own schema included
in the file, so this may be less useful for them. Note that Spark also sometimes
uses the term <code class="docutils literal notranslate"><span class="pre">bigint</span></code> to mean the same thing as <code class="docutils literal notranslate"><span class="pre">long</span></code>.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">datasource_a</span><span class="p">]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;us1900&quot;</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/my_file.csv&quot;</span>
<span class="n">convert_ints_to_longs</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="filter">
<h2>Filter<a class="headerlink" href="#filter" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">filter</span></code></p></li>
<li><p>Description: Specifies filters to apply to your input data.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">expression</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. SQL expression to apply to your input datasets. Can not be combined with <code class="docutils literal notranslate"><span class="pre">training_data_subset</span></code> in a single filter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">training_data_subset</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. If set to true, will subset your input data to only include records that are also in your training data. Can not be combined with <code class="docutils literal notranslate"><span class="pre">expression</span></code> in a single filter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasource</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. If you want to limit the filter to operate only on dataset a or b, you can specify that with this attribute.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="nb">filter</span><span class="p">]]</span>
<span class="n">training_data_subset</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">datasource</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>

<span class="p">[[</span><span class="nb">filter</span><span class="p">]]</span>
<span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;NAMELAST is not null and NAMELAST != &#39;&#39;&quot;</span>

<span class="p">[[</span><span class="nb">filter</span><span class="p">]]</span>
<span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;age &gt;= 5&quot;</span>
<span class="n">datasource</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>
</pre></div>
</div>
</section>
<section id="column-mappings">
<h2><a class="reference internal" href="column_mapping_transforms.html"><span class="doc">Column Mappings</span></a><a class="headerlink" href="#column-mappings" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">column_mappings</span></code></p></li>
<li><p>Description: Base column mappings and transformations to extract from your input datasets.</p></li>
<li><p>Required: True</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">alias</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Optional; if not specified the new column name defaults to <code class="docutils literal notranslate"><span class="pre">column_name</span></code>. New name of column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Name of column in input data. Used as the name of the output column if <code class="docutils literal notranslate"><span class="pre">alias</span></code> is not specified.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transforms</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">List</span></code>. Optional. A list of transforms to apply, in order, to the input data. See the <a class="reference internal" href="column_mapping_transforms.html"><span class="doc">column mapping transforms</span></a> section for more information.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;age&quot;</span>

<span class="p">[[</span><span class="n">column_mappings</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_clean&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst&quot;</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;lowercase_strip&quot;</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;rationalize_name_words&quot;</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;remove_qmark_hyphen&quot;</span><span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;replace_apostrophe&quot;</span><span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;remove_suffixes&quot;</span><span class="p">,</span>  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;jr&quot;</span><span class="p">,</span> <span class="s2">&quot;sr&quot;</span><span class="p">,</span> <span class="s2">&quot;ii&quot;</span><span class="p">,</span> <span class="s2">&quot;iii&quot;</span><span class="p">,</span> <span class="s2">&quot;iv&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;vi&quot;</span><span class="p">,</span> <span class="s2">&quot;vii&quot;</span><span class="p">,</span> <span class="s2">&quot;viii&quot;</span><span class="p">]</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;remove_alternate_names&quot;</span><span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;condense_strip_whitespace&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="substitution-columns">
<h2><a class="reference internal" href="substitutions.html"><span class="doc">Substitution Columns</span></a><a class="headerlink" href="#substitution-columns" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">substitution_columns</span></code></p></li>
<li><p>Description: Substitutions to apply to data after column mappings.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. Column to apply substitutions to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">substitutions</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">list</span></code>. A list of substitutions to apply. See the <a class="reference internal" href="substitutions.html"><span class="doc">substitutions</span></a> section for more information.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">substitution_columns</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_std&quot;</span>

<span class="p">[[</span><span class="n">substitution_columns</span><span class="o">.</span><span class="n">substitutions</span><span class="p">]]</span>
<span class="n">join_column</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>
<span class="n">join_value</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
<span class="n">substitution_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/name_std/male.csv&quot;</span>

<span class="p">[[</span><span class="n">substitution_columns</span><span class="o">.</span><span class="n">substitutions</span><span class="p">]]</span>
<span class="n">join_column</span> <span class="o">=</span> <span class="s2">&quot;sex&quot;</span>
<span class="n">join_value</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
<span class="n">substitution_file</span> <span class="o">=</span> <span class="s2">&quot;/path/to/name_std/female.csv&quot;</span>
</pre></div>
</div>
</section>
<section id="feature-selections">
<h2><a class="reference internal" href="feature_selection_transforms.html"><span class="doc">Feature Selections</span></a><a class="headerlink" href="#feature-selections" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">feature_selections</span></code></p></li>
<li><p>Description: A list of feature selections to apply to the input data after substitutions and column mappings. See the <a class="reference internal" href="feature_selection_transforms.html"><span class="doc">feature selection transforms</span></a> section for more information, including information on the specific transforms available.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">input_column</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required.  The name of the input column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_column</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required.  The name of the output column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  The name of the transform to apply to the column.</p></li>
<li><p>Other attributes vary depending on transform type.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">feature_selections</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;namelast_clean&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;namelast_clean_bigrams&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;bigrams&quot;</span>

<span class="p">[[</span><span class="n">feature_selections</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;bpl_clean&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;region&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;attach_variable&quot;</span>
<span class="n">region_dict</span> <span class="o">=</span> <span class="s2">&quot;/path/to/region.csv&quot;</span>
<span class="n">col_to_join_on</span> <span class="o">=</span> <span class="s2">&quot;bpl&quot;</span>
<span class="n">col_to_add</span> <span class="o">=</span> <span class="s2">&quot;region&quot;</span>
<span class="n">null_filler</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">col_type</span> <span class="o">=</span> <span class="s2">&quot;float&quot;</span>
</pre></div>
</div>
</section>
<section id="potential-matches-universe">
<h2>Potential Matches Universe<a class="headerlink" href="#potential-matches-universe" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">potential_matches_universe</span></code></p></li>
<li><p>Description: Limits the universe of created potential matches generated using an expression fed to a SQL query.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">expression</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Required.  The expression to use to filter prepped_df_(a/b) before generating potential matches.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">potential_matches_universe</span><span class="p">]]</span>
<span class="c1"># limits potential matches created to only men</span>
<span class="n">expression</span> <span class="o">=</span> <span class="s2">&quot;sex == 1&quot;</span>
</pre></div>
</div>
</section>
<section id="blocking">
<h2>Blocking<a class="headerlink" href="#blocking" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">blocking</span></code></p></li>
<li><p>Description: Describes what columns to block on and how to create the blocks for the potential matches.</p></li>
<li><p>Required: True</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The name of the column in the existing data to block on if not exploded; The name of the newly exploded column if <code class="docutils literal notranslate"><span class="pre">explode</span> <span class="pre">=</span> <span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">explode</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. Optional. If true, will attempt to “explode” the column by creating duplicate rows for each value in the column. Only works on columns that are arrays of values or when <code class="docutils literal notranslate"><span class="pre">expand_length</span></code> is set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Optional. Must be <code class="docutils literal notranslate"><span class="pre">a</span></code> or <code class="docutils literal notranslate"><span class="pre">b</span></code> and used in conjuction with <code class="docutils literal notranslate"><span class="pre">explode</span></code>. Will only explode the column from the <code class="docutils literal notranslate"><span class="pre">a</span></code> or <code class="docutils literal notranslate"><span class="pre">b</span></code> dataset when specified.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">derived_from</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Used in conjunction with <code class="docutils literal notranslate"><span class="pre">explode</span> <span class="pre">=</span> <span class="pre">true</span></code>.  Specifies an input column from the existing dataset to be exploded.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expand_length</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">integer</span></code>. When <code class="docutils literal notranslate"><span class="pre">explode</span></code> is used on a column that is an integer, this can be specified to create an array with a range of integer values from (<code class="docutils literal notranslate"><span class="pre">expand_length</span></code> minus <code class="docutils literal notranslate"><span class="pre">original_value</span></code>) to (<code class="docutils literal notranslate"><span class="pre">expand_length</span></code> plus <code class="docutils literal notranslate"><span class="pre">original_value</span></code>).  For example, if the input column value for birthyr is 1870, explode is true, and the expand_length is 3, the exploded column birthyr_3 value would be the array [1867, 1868, 1869, 1870, 1871, 1872, 1873].</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;bpl&quot;</span>

<span class="p">[[</span><span class="n">blocking</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;birthyr_3&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="n">derived_from</span> <span class="o">=</span> <span class="s2">&quot;birthyr&quot;</span>
<span class="n">expand_length</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">explode</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
</section>
<section id="comparisons">
<h2><a class="reference internal" href="comparison_types.html"><span class="doc">Comparisons</span></a><a class="headerlink" href="#comparisons" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">comparisons</span></code></p></li>
<li><p>Description: A list of comparisons to threshold the potential matches on. Only potential matches that pass the thresholds will be created. See <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> for more information.</p></li>
<li><p>Required: True</p></li>
<li><p>Type: Object</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">comparison_type</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. See <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feature_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The <code class="docutils literal notranslate"><span class="pre">comparison_feature</span></code> to use for the comparison threshold.  A <code class="docutils literal notranslate"><span class="pre">comparison_feature</span></code> column by this name must be specified in the <code class="docutils literal notranslate"><span class="pre">comparison_features</span></code> section.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">comparisons</span><span class="p">]</span>
<span class="n">operator</span> <span class="o">=</span> <span class="s2">&quot;AND&quot;</span>

<span class="p">[</span><span class="n">comparisons</span><span class="o">.</span><span class="n">comp_a</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_jw&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.79</span>

<span class="p">[</span><span class="n">comparisons</span><span class="o">.</span><span class="n">comp_b</span><span class="p">]</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;namelast_jw&quot;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.79</span>
</pre></div>
</div>
</section>
<section id="household-comparisons">
<h2><a class="reference internal" href="comparison_types.html"><span class="doc">Household Comparisons</span></a><a class="headerlink" href="#household-comparisons" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">hh_comparisons</span></code></p></li>
<li><p>Description: A list of comparisons to threshold the household potential matches on. Also referred to as post-blocking filters, as all household potential matches are created, then only potential matches that pass the post-blocking filters will be kept for scoring. See <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> for more information.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: Object</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">comparison_type</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Required. See <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feature_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The <code class="docutils literal notranslate"><span class="pre">comparison_feature</span></code> to use for the comparison threshold. A <code class="docutils literal notranslate"><span class="pre">comparison_feature</span></code> column by this name must be specified in the <code class="docutils literal notranslate"><span class="pre">comparison_features</span></code> section.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">hh_comparisons</span><span class="p">]</span>
<span class="c1"># only keep household potential matches with an age difference less than or equal than ten years</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;threshold&quot;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;byrdiff&quot;</span>
<span class="n">threshold_expr</span> <span class="o">=</span> <span class="s2">&quot;&lt;= 10&quot;</span>
</pre></div>
</div>
</section>
<section id="comparison-features">
<h2><a class="reference internal" href="comparison_types.html"><span class="doc">Comparison Features</span></a><a class="headerlink" href="#comparison-features" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">comparison_features</span></code></p></li>
<li><p>Description: A list of comparison features to create when comparing records. Comparisons for individual and household linking rounds are both represented here – no need to duplicate comparisons if used in both rounds, simply specify the <code class="docutils literal notranslate"><span class="pre">column_name</span></code> in the appropriate <code class="docutils literal notranslate"><span class="pre">training</span></code> or <code class="docutils literal notranslate"><span class="pre">hh_training</span></code> section of the config.  See the <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> section for more information.</p></li>
<li><p>Required: True</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">alias</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Optional. The name of the comparison feature column to be generated.  If not specified, the output column will default to <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">column_name</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the columns to compare.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comparison_type</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the comparison type to use. See the <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> section for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">categorical</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>.  Optional.  Whether the output data should be treated as categorical data (important information used during one-hot encoding and vectorizing in the machine learning pipeline stage).</p></li>
<li><p>Other attributes may be included as well depending on <code class="docutils literal notranslate"><span class="pre">comparison_type</span></code>.  See the <a class="reference internal" href="comparison_types.html"><span class="doc">comparison types</span></a> section for details on each comparison type.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;race&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;race&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;equals&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;namefrst_jw&quot;</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;namefrst_unstd&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;jaro_winkler&quot;</span>

<span class="p">[[</span><span class="n">comparison_features</span><span class="p">]]</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s2">&quot;durmarr&quot;</span>
<span class="n">comparison_type</span> <span class="o">=</span> <span class="s2">&quot;new_marr&quot;</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</section>
<section id="pipeline-generated-features">
<h2><a class="reference internal" href="pipeline_features.html"><span class="doc">Pipeline-generated Features</span></a><a class="headerlink" href="#pipeline-generated-features" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">pipeline_features</span></code></p></li>
<li><p>Description: Features to be added in the model pipeline created for scoring a dataset. These features cannot be used in the <code class="docutils literal notranslate"><span class="pre">comparisons</span></code> section of the config and are for creating more robust ML models.  They typically leverage code available in the Spark Pipeline API.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: List</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">transformer_type</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. See <a class="reference internal" href="pipeline_features.html"><span class="doc">pipeline features</span></a> for more information on the available transformer types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_column</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Either use <code class="docutils literal notranslate"><span class="pre">input_column</span></code> or <code class="docutils literal notranslate"><span class="pre">input_columns</span></code>. Used if a single input_column is needed for the pipeline feature.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_columns</span></code> – Type: List of strings. Either use <code class="docutils literal notranslate"><span class="pre">input_column</span></code> or <code class="docutils literal notranslate"><span class="pre">input_columns</span></code>.  Used if a list of input_columns is needed for the pipeline feature.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_column</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. The name of the new pipeline feature column to be generated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">categorical</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. Optional.  Whether the output data should be treated as categorical data (important information used during one-hot encoding and vectorizing in the machine learning pipeline stage).</p></li>
<li><p>Other attributes may be included as well depending on the particular pipline feature <code class="docutils literal notranslate"><span class="pre">transformer_type</span></code>.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">pipeline_features</span><span class="p">]]</span>
<span class="n">input_columns</span> <span class="o">=</span>  <span class="p">[</span><span class="s2">&quot;sex_equals&quot;</span><span class="p">,</span> <span class="s2">&quot;regionf&quot;</span><span class="p">]</span>
<span class="n">output_column</span> <span class="o">=</span>  <span class="s2">&quot;sex_regionf_interaction&quot;</span>
<span class="n">transformer_type</span> <span class="o">=</span>  <span class="s2">&quot;interaction&quot;</span>

<span class="p">[[</span><span class="n">pipeline_features</span><span class="p">]]</span>
<span class="n">input_column</span> <span class="o">=</span> <span class="s2">&quot;immyear_diff&quot;</span>
<span class="n">output_column</span> <span class="o">=</span> <span class="s2">&quot;immyear_caution&quot;</span>
<span class="n">transformer_type</span> <span class="o">=</span> <span class="s2">&quot;bucketizer&quot;</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">9999</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="training-and-models">
<h2>Training and <a class="reference internal" href="models.html"><span class="doc">models</span></a><a class="headerlink" href="#training-and-models" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">training</span></code></p></li>
<li><p>Description: Specifies the training data set as well as a myriad of attributes related to training a model including the dependent variable within that dataset, the independent variables created from the <code class="docutils literal notranslate"><span class="pre">comparison_features</span></code> section, and the different models you want to use for either model exploration or scoring.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: Object</p></li>
<li><p>Attributes:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Location of the training dataset. Must be a csv file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dependent_var</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Name of dependent variable in training dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">independent_vars</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">list</span></code>. List of independent variables to use in the model. These must be either part of <code class="docutils literal notranslate"><span class="pre">pipeline_features</span></code> or <code class="docutils literal notranslate"><span class="pre">comparison_features</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chosen_model</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">object</span></code>. The model to train with in the <code class="docutils literal notranslate"><span class="pre">training</span></code> task and score with in the <code class="docutils literal notranslate"><span class="pre">matching</span></code> task. See the <a class="reference internal" href="models.html"><span class="doc">models</span></a> section for more information on model specifications.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">float</span></code>. The threshold for which to accept model probability values as true predictions.  Can be used to specify a threshold to use for all models, or can be specified within each <code class="docutils literal notranslate"><span class="pre">chosen_model</span></code> and <code class="docutils literal notranslate"><span class="pre">model_parameters</span></code> specification.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decision</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Optional. Specifies which decision function to use to create the final prediction. The first option is <code class="docutils literal notranslate"><span class="pre">drop_duplicate_a</span></code>, which drops any links for which a record in the <code class="docutils literal notranslate"><span class="pre">a</span></code> data set has a predicted match more than one time. The second option is <code class="docutils literal notranslate"><span class="pre">drop_duplicate_with_threshold_ratio</span></code> which only takes links for which the <code class="docutils literal notranslate"><span class="pre">a</span></code> record has the highest probability out of any other potential links, and the second best link for the <code class="docutils literal notranslate"><span class="pre">a</span></code> record is less than the <code class="docutils literal notranslate"><span class="pre">threshold_ratio</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold_ratio</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">float</span></code>. Optional. For use when <code class="docutils literal notranslate"><span class="pre">decision</span></code> is <code class="docutils literal notranslate"><span class="pre">drop_duplicate_with_threshold_ratio</span></code> . Specifies the smallest possible ratio to accept between a best and second best link for a given record.  Can be used to specify a threshold ratio (beta threshold) to use for all models.  Alternatively, unique threshold ratios can be specified in each individual <code class="docutils literal notranslate"><span class="pre">chosen_model</span></code> and <code class="docutils literal notranslate"><span class="pre">model_parameters</span></code> specification.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model_parameters</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">list</span></code>. Specifies models to test out in the <code class="docutils literal notranslate"><span class="pre">model_exploration</span></code> task. See the <a class="reference internal" href="models.html"><span class="doc">models</span></a> section for more information on model specifications.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">param_grid</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. Optional. If you would like to evaluate multiple hyper-parameters for a single model type in your <code class="docutils literal notranslate"><span class="pre">model_parameters</span></code> specification, you can give hyper-parameter inputs as arrays of length &gt;= 1 instead of integers to allow one model per row specification with multiple model eval outputs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">score_with_model</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. If set to false, will skip the <code class="docutils literal notranslate"><span class="pre">apply_model</span></code> step of the matching task. Use this if you want to use the <code class="docutils literal notranslate"><span class="pre">run_all_steps</span></code> command and are just trying to generate potential links, such as for the creation of training data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_training_iterations</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">integer</span></code>. Optional; default value is 10. The number of training iterations to use during the <code class="docutils literal notranslate"><span class="pre">model_exploration</span></code> task.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale_data</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>.  Optional. Whether to scale the data as part of the machine learning pipeline.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_training_data_features</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. Optional. If the identifiers in the training data set are not present in your raw input data, you will need to set this to <code class="docutils literal notranslate"><span class="pre">true</span></code>, or training features will not be able to be generated, giving null column errors.  For example, if the training data set you are using has individuals from 1900 and 1910, but you are about to train a model to score the 1930-1940 potential matches, you need this to be set to <code class="docutils literal notranslate"><span class="pre">true</span></code> or it will fail, since the individual IDs are not present in the 1930 and 1940 raw input data.  If you were about to train a model to score the 1900-1910 potential matches with this same training set, it would be best to set this to <code class="docutils literal notranslate"><span class="pre">false</span></code>, so you can be sure the training features are created from scratch to match your exact current configuration settings, although if you know the features haven’t changed, you could set it to <code class="docutils literal notranslate"><span class="pre">true</span></code> to save a small amount of processing time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_suspicious_TD</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>.  Optional.  Used in the <code class="docutils literal notranslate"><span class="pre">model_exploration</span></code> link task.  Outputs tables of potential matches that the model repeatedly scores differently than the match value given by the training data.  Helps to identify false positives/false negatives in the training data, as well as areas that need additional training feature coverage in the model, or need increased representation in the training data set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">split_by_id_a</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>.  Optional.  Used in the <code class="docutils literal notranslate"><span class="pre">model_exploration</span></code> link task.  When set to true, ensures that all potential matches for a given individual with ID_a are grouped together in the same train-test-split group. For example, if individual histid_a “A304BT” has three potential matches in the training data, one each to histid_b “B200”, “C201”, and “D425”, all of those potential matches would either end up in the “train” split or the “test” split when evaluating the model performance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feature_importances</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. Optional, and currently not functional.  Whether to record feature importances for the training features when training or evaluating an ML model.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">training</span><span class="p">]</span>
<span class="n">independent_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;race&quot;</span><span class="p">,</span> <span class="s2">&quot;srace&quot;</span><span class="p">,</span> <span class="s2">&quot;race_interacted_srace&quot;</span><span class="p">,</span> <span class="s2">&quot;hits&quot;</span><span class="p">,</span> <span class="s2">&quot;hits2&quot;</span><span class="p">,</span> <span class="s2">&quot;exact_mult&quot;</span><span class="p">,</span> <span class="s2">&quot;ncount&quot;</span><span class="p">,</span> <span class="s2">&quot;ncount2&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;namefrst_jw&quot;</span><span class="p">,</span><span class="s2">&quot;namelast_jw&quot;</span><span class="p">,</span><span class="s2">&quot;namefrst_std_jw&quot;</span><span class="p">,</span><span class="s2">&quot;byrdiff&quot;</span><span class="p">,</span> <span class="s2">&quot;f_interacted_jw_f&quot;</span><span class="p">,</span> <span class="s2">&quot;jw_f&quot;</span><span class="p">,</span> <span class="s2">&quot;f_caution&quot;</span><span class="p">,</span> <span class="s2">&quot;f_pres&quot;</span><span class="p">,</span> <span class="s2">&quot;fbplmatch&quot;</span><span class="p">,</span> <span class="s2">&quot;m_interacted_jw_m&quot;</span><span class="p">,</span> <span class="s2">&quot;jw_m&quot;</span><span class="p">,</span> <span class="s2">&quot;m_caution&quot;</span><span class="p">,</span> <span class="s2">&quot;m_pres&quot;</span><span class="p">,</span> <span class="s2">&quot;mbplmatch&quot;</span><span class="p">,</span> <span class="s2">&quot;sp_interacted_jw_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;jw_sp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp_caution&quot;</span><span class="p">,</span> <span class="s2">&quot;sp_pres&quot;</span><span class="p">,</span> <span class="s2">&quot;mi&quot;</span><span class="p">,</span> <span class="s2">&quot;fsoundex&quot;</span><span class="p">,</span> <span class="s2">&quot;lsoundex&quot;</span><span class="p">,</span> <span class="s2">&quot;rel&quot;</span><span class="p">,</span> <span class="s2">&quot;oth&quot;</span><span class="p">,</span> <span class="s2">&quot;sgen&quot;</span><span class="p">,</span> <span class="s2">&quot;nbors&quot;</span><span class="p">,</span> <span class="s2">&quot;county_distance&quot;</span><span class="p">,</span> <span class="s2">&quot;county_distance_squared&quot;</span><span class="p">,</span> <span class="s2">&quot;street_jw&quot;</span><span class="p">,</span> <span class="s2">&quot;imm_interacted_immyear_caution&quot;</span><span class="p">,</span> <span class="s2">&quot;immyear_diff&quot;</span><span class="p">,</span> <span class="s2">&quot;imm&quot;</span><span class="p">]</span>
<span class="n">scale_data</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;/path/to/1900_1910_training_data_20191023.csv&quot;</span>
<span class="n">dependent_var</span> <span class="o">=</span> <span class="s2">&quot;match&quot;</span>
<span class="n">use_training_data_features</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">output_suspicious_TD</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">split_by_id_a</span> <span class="o">=</span> <span class="n">true</span>

<span class="n">score_with_model</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">feature_importances</span> <span class="o">=</span> <span class="n">true</span>

<span class="n">decision</span> <span class="o">=</span> <span class="s2">&quot;drop_duplicate_with_threshold_ratio&quot;</span>

<span class="n">n_training_iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">model_parameters</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="n">maxDepth</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">numTrees</span> <span class="o">=</span> <span class="mi">50</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;probit&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">chosen_model</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="household-training-and-models">
<h2>Household training and models<a class="headerlink" href="#household-training-and-models" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Header name: <code class="docutils literal notranslate"><span class="pre">hh_training</span></code></p></li>
<li><p>Description: Specifies the household training data set as well as a myriad of attributes related to training a model including the dependent var within that data set, the independent vars created from the <code class="docutils literal notranslate"><span class="pre">comparison_features</span></code> section, and the different models you want to use.</p></li>
<li><p>Required: False</p></li>
<li><p>Type: Object</p></li>
<li><p>Attributes:</p>
<ul>
<li><p>All of the attributes and <a class="reference internal" href="models.html"><span class="doc">models</span></a> available in <a class="reference external" href="#training-and-models">training</a> may also be used here.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>.  Required. The name of the column that the final prediction value is recorded in the individual linking round scoring step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hh_col</span></code> – Type: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Required. The name of the column with the household identifier.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">hh_training</span><span class="p">]</span>
<span class="n">prediction_col</span> <span class="o">=</span> <span class="s2">&quot;prediction&quot;</span>
<span class="n">hh_col</span> <span class="o">=</span> <span class="s2">&quot;serialp&quot;</span>

<span class="n">independent_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;namelast_jw&quot;</span><span class="p">,</span><span class="s2">&quot;namefrst_jw&quot;</span><span class="p">,</span><span class="s2">&quot;namefrst_std_jw&quot;</span><span class="p">,</span> <span class="s2">&quot;jw_max_a&quot;</span><span class="p">,</span> <span class="s2">&quot;jw_max_b&quot;</span><span class="p">,</span> <span class="s2">&quot;f1_match&quot;</span><span class="p">,</span> <span class="s2">&quot;f2_match&quot;</span><span class="p">,</span> <span class="s2">&quot;byrdifcat&quot;</span><span class="p">,</span> <span class="s2">&quot;racematch&quot;</span><span class="p">,</span> <span class="s2">&quot;imm&quot;</span><span class="p">,</span> <span class="s2">&quot;bplmatch&quot;</span><span class="p">,</span> <span class="s2">&quot;imm_interacted_bplmatch&quot;</span><span class="p">,</span> <span class="s2">&quot;sexmatch&quot;</span><span class="p">,</span> <span class="s2">&quot;mardurmatch&quot;</span><span class="p">,</span> <span class="s2">&quot;relatetype&quot;</span><span class="p">,</span> <span class="s2">&quot;relatematch&quot;</span><span class="p">,</span> <span class="s2">&quot;relatetype_interacted_relatematch&quot;</span><span class="p">]</span>

<span class="n">scale_data</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;/path/to/hh_training_data_1900_1910.csv&quot;</span>
<span class="n">dependent_var</span> <span class="o">=</span> <span class="s2">&quot;match&quot;</span>
<span class="n">use_training_data_features</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">output_suspicious_TD</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">split_by_id_a</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">score_with_model</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">feature_importances</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">decision</span> <span class="o">=</span> <span class="s2">&quot;drop_duplicate_with_threshold_ratio&quot;</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">n_training_iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">model_parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">]},</span>
    <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="n">maxDepth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">numTrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">threshold</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]}</span>
<span class="p">]</span>

<span class="n">chosen_model</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">threshold_ratio</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">}</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">hlink</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="link_tasks.html">Link Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_the_program.html">Running hlink</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_examples.html">Advanced Workflows</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-config-file">Basic Config File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-config-file">Advanced Config File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#top-level-configs">Top level configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-sources">Data sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filter">Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#column-mappings">Column Mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#substitution-columns">Substitution Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#feature-selections">Feature Selections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#potential-matches-universe">Potential Matches Universe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#blocking">Blocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparisons">Comparisons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#household-comparisons">Household Comparisons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparison-features">Comparison Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipeline-generated-features">Pipeline-generated Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#training-and-models">Training and models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#household-training-and-models">Household training and models</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="column_mapping_transforms.html">Column Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_types.html">Comparison Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_selection_transforms.html">Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline_features.html">Pipeline Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="substitutions.html">Substitutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="use_examples.html" title="previous chapter">Advanced Workflow Examples</a></li>
      <li>Next: <a href="column_mapping_transforms.html" title="next chapter">Column mapping transforms</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019-2022, IPUMS.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/config.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>